{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}Proyecto Kairos{% endblock %}</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="{% static 'css/headerfooter.css' %}?v=final2">
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    
    {% block content %}{% endblock %}
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- LÓGICA MAESTRA DEL MENÚ MÓVIL ---
            const header = document.querySelector('header');
            const logo = document.querySelector('.logo');

            if (header && logo) {
                // 1. Abrir/Cerrar al tocar el logo
                logo.addEventListener('click', (e) => {
                    if (window.innerWidth <= 768) {
                        e.stopPropagation(); 
                        header.classList.toggle('menu-open');
                    }
                });

                // 2. Cerrar al hacer clic FUERA del menú (¡Fundamental para UX!)
                document.addEventListener('click', (e) => {
                    if (header.classList.contains('menu-open') && !header.contains(e.target)) {
                        header.classList.remove('menu-open');
                    }
                });

                // 3. Resetear si se cambia a modo escritorio
                window.addEventListener('resize', () => {
                    if (window.innerWidth > 768) {
                        header.classList.remove('menu-open');
                    }
                });
            }

            // --- MENÚ DESPLEGABLE "CONTACT" (STICKY) ---
            const dropdown = document.getElementById('contactDropdown');
            if (dropdown) {
                const dropdownContent = dropdown.querySelector('.dropdown-content');
                let closeTimer = null;
                const openMenu = () => {
                    if (closeTimer) { clearTimeout(closeTimer); closeTimer = null; }
                    dropdownContent.classList.add('show');
                };
                const startCloseTimer = () => {
                    if (!closeTimer) {
                        closeTimer = setTimeout(() => { dropdownContent.classList.remove('show'); closeTimer = null; }, 250);
                    }
                };
                dropdown.addEventListener('mouseenter', openMenu);
                dropdown.addEventListener('mouseleave', startCloseTimer);
                // Cerrar al hacer clic en un enlace del dropdown
                dropdownContent.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => { dropdownContent.classList.remove('show'); });
                });
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
    
</body>
</html>